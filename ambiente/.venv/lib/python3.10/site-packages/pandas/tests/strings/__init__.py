# Path: ambiente/.venv/lib/python3.10/site-packages/pandas/tests/strings/__init__.py
# Purpose (en): <write English purpose here>
# Propósito (pt-BR): <escreva em Português aqui>

# Path: ambiente/.venv/lib/python3.10/site-packages/pandas/tests/strings/__init__.py
# Purpose (en): <write English purpose here>
# Propósito (pt-BR): <escreva em Português aqui>

import numpy as np

import pandas as pd

object_pyarrow_numpy = ("object", "string[pyarrow_numpy]")


def _convert_na_value(ser, expected):
    if ser.dtype != object:
        if ser.dtype.storage == "pyarrow_numpy":
            expected = expected.fillna(np.nan)
        else:
            # GH#18463
            expected = expected.fillna(pd.NA)
    return expected
