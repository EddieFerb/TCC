# Path: ambiente/.venv/lib/python3.10/site-packages/sklearn/utils/tests/test_weight_vector.py
# Purpose (en): <write English purpose here>
# Propósito (pt-BR): <escreva em Português aqui>

# Path: ambiente/.venv/lib/python3.10/site-packages/sklearn/utils/tests/test_weight_vector.py
# Purpose (en): <write English purpose here>
# Propósito (pt-BR): <escreva em Português aqui>

import numpy as np
import pytest

from sklearn.utils._weight_vector import (
    WeightVector32,
    WeightVector64,
)


@pytest.mark.parametrize(
    "dtype, WeightVector",
    [
        (np.float32, WeightVector32),
        (np.float64, WeightVector64),
    ],
)
def test_type_invariance(dtype, WeightVector):
    """Check the `dtype` consistency of `WeightVector`."""
    weights = np.random.rand(100).astype(dtype)
    average_weights = np.random.rand(100).astype(dtype)

    weight_vector = WeightVector(weights, average_weights)

    assert np.asarray(weight_vector.w).dtype is np.dtype(dtype)
    assert np.asarray(weight_vector.aw).dtype is np.dtype(dtype)
